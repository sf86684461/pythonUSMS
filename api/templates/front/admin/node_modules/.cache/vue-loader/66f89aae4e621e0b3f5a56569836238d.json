{"remainingRequest":"/Users/shaofeng/Desktop/codebuddy/pythonUSMS-1/api/templates/front/admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/shaofeng/Desktop/codebuddy/pythonUSMS-1/api/templates/front/admin/src/components/common/img.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/shaofeng/Desktop/codebuddy/pythonUSMS-1/api/templates/front/admin/src/components/common/img.vue","mtime":1757455257866},{"path":"/Users/shaofeng/Desktop/codebuddy/pythonUSMS-1/api/templates/front/admin/node_modules/babel-loader/lib/index.js","mtime":1757455255863},{"path":"/Users/shaofeng/Desktop/codebuddy/pythonUSMS-1/api/templates/front/admin/node_modules/cache-loader/dist/cjs.js","mtime":1757455255994},{"path":"/Users/shaofeng/Desktop/codebuddy/pythonUSMS-1/api/templates/front/admin/node_modules/vue-loader/lib/index.js","mtime":1757455257715}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CiAgZXhwb3J0IGRlZmF1bHQgewogICAgbmFtZTogIlhYWCIsCiAgICBkYXRhKCkgewogICAgICByZXR1cm4gew0KCQliYXNlVXJsOmAvJHt0aGlzLiRiYXNlLm5hbWV9L2AsCiAgICAgICAgdmlzaWJsZTogZmFsc2UsIC8v5by556qXCiAgICAgICAgbG9hZGluZzogZmFsc2UsIC8v5LiK5Lyg5oyJ6ZKu5Yqg6L29CiAgICAgICAgb3M6IGZhbHNlLCAvL+aOp+WItuaRhOWDj+WktOW8gOWFswogICAgICAgIHRoaXNWaWRlbzogbnVsbCwKICAgICAgICB0aGlzQ29udGV4dDogbnVsbCwKICAgICAgICB0aGlzQ2FuY2FzOiBudWxsLAogICAgICAgIHZpZGVvV2lkdGg6IDUwMCwKICAgICAgICB2aWRlb0hlaWdodDogNDAwLAogICAgICAgIHBvc3RPcHRpb25zOiBbXSwKICAgICAgICBDZXJ0Q3RsOiAnJywKICAgICAgICAvLyDpga7nvanlsYIKICAgICAgICBsb2FkaW5nOiB0cnVlLAogICAgICAgIC8vIOmAieS4reaVsOe7hAogICAgICAgIGlkczogW10sCiAgICAgICAgLy8g6Z2e5Y2V5Liq56aB55SoCiAgICAgICAgc2luZ2xlOiB0cnVlLAogICAgICAgIC8vIOmdnuWkmuS4quemgeeUqAogICAgICAgIG11bHRpcGxlOiB0cnVlLAogICAgICAgIC8vIOaAu+adoeaVsAogICAgICAgIHRvdGFsOiAwLAogICAgICAgIC8vIOmhueebruS6uuWRmOihqOagvOaVsOaNrgogICAgICAgIGFrd29ya2VyTGlzdDogW10sCiAgICAgICAgLy/lt6Xnp43nsbvliKvmlbDmja7lrZflhbgKICAgICAgICB3b3JrZXJUeXBlT3B0aW9uczogW10sCiAgICAgICAgLy8g5by55Ye65bGC5qCH6aKYCiAgICAgICAgdGl0bGU6ICIiLAogICAgICAgIC8vIOaYr+WQpuaYvuekuuW8ueWHuuWxggogICAgICAgIG9wZW46IGZhbHNlLAogICAgICAgIC8vIOafpeivouWPguaVsAogICAgICAgIHF1ZXJ5UGFyYW1zOiB7CiAgICAgICAgICBwYWdlTnVtOiAxLAogICAgICAgICAgcGFnZVNpemU6IDEwLAogICAgICAgICAgaW1nU3JjOiB1bmRlZmluZWQsCiAgICAgICAgfSwKICAgICAgICAvLyDooajljZXlj4LmlbAKCiAgICAgICAgZm9ybToge30sCgogICAgICAgIC8vIOihqOWNleagoemqjAoKICAgICAgICBydWxlczogewoKICAgICAgICB9CgogICAgICB9OwoKICAgIH0sCgogICAgY3JlYXRlZCgpIHsKICAgICAgLy8gdGhpcy5vblRha2UoKQogICAgfSwKCQogICAgbWV0aG9kczogewoKICAgICAgLyrosIPnlKjmkYTlg4/lpLTmi43nhaflvIDlp4sqLwoKICAgICAgb25UYWtlKCkgewoKICAgICAgICB0aGlzLnZpc2libGUgPSB0cnVlOwoKICAgICAgICB0aGlzLmdldENvbXBldGVuY2UoKTsKCiAgICAgIH0sCgogICAgICBvbkNhbmNlbCgpIHsKCQl0aGlzLnVwbG9hZEltZygpCiAgICAgICAgdGhpcy52aXNpYmxlID0gZmFsc2U7CiAgICAgICAgLyogdGhpcy5yZXNldENhbnZhcygpOyovCgogICAgICAgIHRoaXMuc3RvcE5hdmlnYXRvcigpOwoKICAgICAgfSwNCgkgIHVwbG9hZFN1Y2Nlc3MoZSl7DQoJCSAgdGhpcy52aXNpYmxlID0gZmFsc2U7DQoJCSAgdGhpcy4kZW1pdCgnaW1nQ2hhbmdlJywgZS5maWxlKQ0KCSAgfSwKCQl1cGxvYWRJbWcoKXsNCgkJCWxldCBwYXJhbSA9IG5ldyBGb3JtRGF0YSgpDQoJCQnjgIDjgIBwYXJhbS5hcHBlbmQoJ2ZpbGUnLHRoaXMuYmFzZTY0dG9GaWxlKHRoaXMuaW1nU3JjKSkNCgkJCXRoaXMuJGh0dHAucG9zdCgnZmlsZS91cGxvYWQnLHBhcmFtKS50aGVuKHJlcz0+ew0KCQkJCXRoaXMuJGVtaXQoJ2ltZ0NoYW5nZScsIHJlcy5kYXRhLmZpbGUpDQoJCQl9KQ0KCQl9LA0KCQliYXNlNjR0b0ZpbGUgKGRhdGF1cmwsIGZpbGVuYW1lID0gJ2ZpbGUnKSB7DQoJCSAgbGV0IGFyciA9IGRhdGF1cmwuc3BsaXQoJywnKQ0KCQkgICAgICAgIGxldCBtaW1lID0gYXJyWzBdLm1hdGNoKC86KC4qPyk7LylbMV0NCgkJICAgICAgICBsZXQgc3VmZml4ID0gbWltZS5zcGxpdCgnLycpWzFdDQoJCSAgICAgICAgbGV0IGJzdHIgPSBhdG9iKGFyclsxXSkNCgkJICAgICAgICBsZXQgbiA9IGJzdHIubGVuZ3RoDQoJCSAgICAgICAgbGV0IHU4YXJyID0gbmV3IFVpbnQ4QXJyYXkobikNCgkJICAgICAgICB3aGlsZSAobi0tKSB7DQoJCSAgICAgICAgICB1OGFycltuXSA9IGJzdHIuY2hhckNvZGVBdChuKQ0KCQkgICAgICAgIH0NCgkJICAgICAgICBsZXQgZmlsZSA9IG5ldyBGaWxlKFt1OGFycl0sIGAke2ZpbGVuYW1lfS4ke3N1ZmZpeH1gLCB7DQoJCSAgICAgICAgICB0eXBlOiBtaW1lDQoJCSAgICAgICAgfSkNCgkJICAgICAgICByZXR1cm4gZmlsZQ0KCQl9LAogICAgICAvLyDosIPnlKjmkYTlg4/lpLTmnYPpmZAKCiAgICAgIGdldENvbXBldGVuY2UoKSB7CgogICAgICAgIC8v5b+F6aG75ZyobW9kZWzkuK1yZW5kZXLlkI7miY3lj6/ojrflj5bliLBkb23oioLngrks55u05o6l6I635Y+W5peg5rOV6I635Y+W5YiwbW9kZWzkuK3nmoRkb23oioLngrkKCiAgICAgICAgdGhpcy4kbmV4dFRpY2soKCkgPT4gewoKICAgICAgICAgIGNvbnN0IF90aGlzID0gdGhpczsKCiAgICAgICAgICB0aGlzLm9zID0gZmFsc2U7IC8v5YiH5o2i5oiQ5YWz6Zet5pGE5YOP5aS0CgogICAgICAgICAgdGhpcy50aGlzQ2FuY2FzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NhbnZhc0NhbWVyYScpOwoKICAgICAgICAgIHRoaXMudGhpc0NvbnRleHQgPSB0aGlzLnRoaXNDYW5jYXMuZ2V0Q29udGV4dCgnMmQnKTsKCiAgICAgICAgICB0aGlzLnRoaXNWaWRlbyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd2aWRlb0NhbWVyYScpOwoKICAgICAgICAgIC8vIOaXp+eJiOacrOa1j+iniOWZqOWPr+iDveagueacrOS4jeaUr+aMgW1lZGlhRGV2aWNlc++8jOaIkeS7rOmmluWFiOiuvue9ruS4gOS4quepuuWvueixoQoKICAgICAgICAgIGlmIChuYXZpZ2F0b3IubWVkaWFEZXZpY2VzID09PSB1bmRlZmluZWQpIHsKCiAgICAgICAgICAgIG5hdmlnYXRvci5tZW5hdmlnYXRvcmRpYURldmljZXMgPSB7fQoKICAgICAgICAgIH0KCiAgICAgICAgICAvLyDkuIDkupvmtY/op4jlmajlrp7njrDkuobpg6jliIZtZWRpYURldmljZXPvvIzmiJHku6zkuI3og73lj6rliIbphY3kuIDkuKrlr7nosaEKCiAgICAgICAgICAvLyDkvb/nlKhnZXRVc2VyTWVkaWHvvIzlm6DkuLrlroPkvJropobnm5bnjrDmnInnmoTlsZ7mgKfjgIIKCiAgICAgICAgICAvLyDov5nph4zvvIzlpoLmnpznvLrlsJFnZXRVc2VyTWVkaWHlsZ7mgKfvvIzlsLHmt7vliqDlroPjgIIKCiAgICAgICAgICBpZiAobmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEgPT09IHVuZGVmaW5lZCkgewoKICAgICAgICAgICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEgPSBmdW5jdGlvbihjb25zdHJhaW50cykgewoKICAgICAgICAgICAgICAvLyDpppblhYjojrflj5bnjrDlrZjnmoRnZXRVc2VyTWVkaWEo5aaC5p6c5a2Y5ZyoKQoKICAgICAgICAgICAgICBsZXQgZ2V0VXNlck1lZGlhID0gbmF2aWdhdG9yLndlYmtpdEdldFVzZXJNZWRpYSB8fCBuYXZpZ2F0b3IubW96R2V0VXNlck1lZGlhIHx8IG5hdmlnYXRvcgogICAgICAgICAgICAgICAgLmdldFVzZXJNZWRpYTsKCiAgICAgICAgICAgICAgLy8g5pyJ5Lqb5rWP6KeI5Zmo5LiN5pSv5oyB77yM5Lya6L+U5Zue6ZSZ6K+v5L+h5oGvCgogICAgICAgICAgICAgIC8vIOS/neaMgeaOpeWPo+S4gOiHtAoKICAgICAgICAgICAgICBpZiAoIWdldFVzZXJNZWRpYSkgewoKICAgICAgICAgICAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChuZXcgRXJyb3IoJ2dldFVzZXJNZWRpYSBpcyBub3QgaW1wbGVtZW50ZWQgaW4gdGhpcyBicm93c2VyJykpCgogICAgICAgICAgICAgIH0KCiAgICAgICAgICAgICAgLy8g5ZCm5YiZ77yM5L2/55SoUHJvbWlzZeWwhuiwg+eUqOWMheijheWIsOaXp+eahG5hdmlnYXRvci5nZXRVc2VyTWVkaWEKCiAgICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkgewoKICAgICAgICAgICAgICAgIGdldFVzZXJNZWRpYS5jYWxsKG5hdmlnYXRvciwgY29uc3RyYWludHMsIHJlc29sdmUsIHJlamVjdCkKCiAgICAgICAgICAgICAgfSkKCiAgICAgICAgICAgIH0KCiAgICAgICAgICB9CgogICAgICAgICAgY29uc3QgY29uc3RyYWludHMgPSB7CgogICAgICAgICAgICBhdWRpbzogZmFsc2UsCgogICAgICAgICAgICB2aWRlbzogewogICAgICAgICAgICAgIHdpZHRoOiBfdGhpcy52aWRlb1dpZHRoLAogICAgICAgICAgICAgIGhlaWdodDogX3RoaXMudmlkZW9IZWlnaHQsCiAgICAgICAgICAgICAgdHJhbnNmb3JtOiAnc2NhbGVYKC0xKScKICAgICAgICAgICAgfQoKICAgICAgICAgIH07CgogICAgICAgICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEoY29uc3RyYWludHMpLnRoZW4oZnVuY3Rpb24oc3RyZWFtKSB7CgogICAgICAgICAgICAvLyDml6fnmoTmtY/op4jlmajlj6/og73msqHmnIlzcmNPYmplY3QKCiAgICAgICAgICAgIGlmICgnc3JjT2JqZWN0JyBpbiBfdGhpcy50aGlzVmlkZW8pIHsKCiAgICAgICAgICAgICAgX3RoaXMudGhpc1ZpZGVvLnNyY09iamVjdCA9IHN0cmVhbQoKICAgICAgICAgICAgfSBlbHNlIHsKCiAgICAgICAgICAgICAgLy8g6YG/5YWN5Zyo5paw55qE5rWP6KeI5Zmo5Lit5L2/55So5a6D77yM5Zug5Li65a6D5q2j5Zyo6KKr5byD55So44CCCgogICAgICAgICAgICAgIF90aGlzLnRoaXNWaWRlby5zcmMgPSB3aW5kb3cuVVJMLmNyZWF0ZU9iamVjdFVSTChzdHJlYW0pCgogICAgICAgICAgICB9CgogICAgICAgICAgICBfdGhpcy50aGlzVmlkZW8ub25sb2FkZWRtZXRhZGF0YSA9IGZ1bmN0aW9uKGUpIHsKCiAgICAgICAgICAgICAgX3RoaXMudGhpc1ZpZGVvLnBsYXkoKQoKICAgICAgICAgICAgfQoKICAgICAgICAgIH0pLmNhdGNoKGVyciA9PiB7CgogICAgICAgICAgICB0aGlzLiRub3RpZnkoewoKICAgICAgICAgICAgICB0aXRsZTogJ+itpuWRiicsCgogICAgICAgICAgICAgIG1lc3NhZ2U6ICfmsqHmnInlvIDlkK/mkYTlg4/lpLTmnYPpmZDmiJbmtY/op4jlmajniYjmnKzkuI3lhbzlrrkuJywKCiAgICAgICAgICAgICAgdHlwZTogJ3dhcm5pbmcnCgogICAgICAgICAgICB9KTsKCiAgICAgICAgICB9KTsKCiAgICAgICAgfSk7CgogICAgICB9LAoKICAgICAgLy/nu5jliLblm77niYcKCiAgICAgIGRyYXdJbWFnZSgpIHsKCiAgICAgICAgLy8g54K55Ye777yMY2FudmFz55S75Zu+CgogICAgICAgIHRoaXMudGhpc0NvbnRleHQuZHJhd0ltYWdlKHRoaXMudGhpc1ZpZGVvLCAwLCAwLCB0aGlzLnZpZGVvV2lkdGgsIHRoaXMudmlkZW9IZWlnaHQpOwoKICAgICAgICAvLyDojrflj5blm77niYdiYXNlNjTpk77mjqUKCiAgICAgICAgdGhpcy5pbWdTcmMgPSB0aGlzLnRoaXNDYW5jYXMudG9EYXRhVVJMKCdpbWFnZS9wbmcnKTsKCiAgICAgICAgLypjb25zdCBpbWdTcmM9dGhpcy5pbWdTcmM7Ki8KCiAgICAgIH0sCgogICAgICAvL+a4heepuueUu+W4gwoKICAgICAgY2xlYXJDYW52YXMoaWQpIHsKCiAgICAgICAgbGV0IGMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChpZCk7CgogICAgICAgIGxldCBjeHQgPSBjLmdldENvbnRleHQoIjJkIik7CgogICAgICAgIGN4dC5jbGVhclJlY3QoMCwgMCwgYy53aWR0aCwgYy5oZWlnaHQpOwoKICAgICAgfSwKCiAgICAgIC8v6YeN572u55S75biDCgogICAgICByZXNldENhbnZhcygpIHsKCiAgICAgICAgdGhpcy5pbWdTcmMgPSAiIjsKCiAgICAgICAgdGhpcy5jbGVhckNhbnZhcygnY2FudmFzQ2FtZXJhJyk7CgogICAgICB9LAoKICAgICAgLy/lhbPpl63mkYTlg4/lpLQKCiAgICAgIHN0b3BOYXZpZ2F0b3IoKSB7CgogICAgICAgIGlmICh0aGlzLnRoaXNWaWRlbyAmJiB0aGlzLnRoaXNWaWRlbyAhPT0gbnVsbCkgewoKICAgICAgICAgIHRoaXMudGhpc1ZpZGVvLnNyY09iamVjdC5nZXRUcmFja3MoKVswXS5zdG9wKCk7CgogICAgICAgICAgdGhpcy5vcyA9IHRydWU7IC8v5YiH5o2i5oiQ5omT5byA5pGE5YOP5aS0CgogICAgICAgIH0KCiAgICAgIH0sCgogICAgICAvKuiwg+eUqOaRhOWDj+WktOaLjeeFp+e7k+adnyovCgogICAgfQoKICB9Owo="},{"version":3,"sources":["img.vue"],"names":[],"mappings":";AAqCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA;;AAEA","file":"img.vue","sourceRoot":"src/components/common","sourcesContent":["<template>\n  <el-dialog title=\"拍照上传\" :visible.sync=\"visible\" width=\"1065px\">\n    <div class=\"box\">\n      <video id=\"videoCamera\" class=\"canvas\" :width=\"videoWidth\" :height=\"videoHeight\" autoPlay></video>\n      <canvas id=\"canvasCamera\" class=\"canvas\" :width=\"videoWidth\" :height=\"videoHeight\"></canvas>\n    </div>\n    <div slot=\"footer\" style=\"display:flex\">\r\n\t\t<el-upload\r\n\t\t  :action=\"$base.url + 'file/upload'\"\r\n\t\t  :on-success=\"uploadSuccess\"\r\n\t\t  :show-file-list=\"false\"\r\n\t\t  accept=\".jpg,.png,.jpge\"\r\n\t\t  style=\"margin-right:10px\">\r\n\t\t  <el-button icon=\"el-icon-upload2\" size=\"small\">\r\n\t\t    上传图片\r\n\t\t  </el-button>\r\n\t\t</el-upload>\n      \n      <el-button @click=\"drawImage\" icon=\"el-icon-camera\" size=\"small\">\n        拍照\n      </el-button>\n      <el-button v-if=\"os\" @click=\"getCompetence\" icon=\"el-icon-video-camera\" size=\"small\">\n        打开摄像头\n      </el-button>\n      <el-button v-else @click=\"stopNavigator\" icon=\"el-icon-switch-button\" size=\"small\">\n        关闭摄像头\n      </el-button>\n      <el-button @click=\"resetCanvas\" icon=\"el-icon-refresh\" size=\"small\">\n        重置\n      </el-button>\n      <el-button @click=\"onCancel\" icon=\"el-icon-circle-close\" size=\"small\">\n        完成\n      </el-button>\n    </div>\n  </el-dialog>\n</template>\n<script>\n  export default {\n    name: \"XXX\",\n    data() {\n      return {\r\n\t\tbaseUrl:`/${this.$base.name}/`,\n        visible: false, //弹窗\n        loading: false, //上传按钮加载\n        os: false, //控制摄像头开关\n        thisVideo: null,\n        thisContext: null,\n        thisCancas: null,\n        videoWidth: 500,\n        videoHeight: 400,\n        postOptions: [],\n        CertCtl: '',\n        // 遮罩层\n        loading: true,\n        // 选中数组\n        ids: [],\n        // 非单个禁用\n        single: true,\n        // 非多个禁用\n        multiple: true,\n        // 总条数\n        total: 0,\n        // 项目人员表格数据\n        akworkerList: [],\n        //工种类别数据字典\n        workerTypeOptions: [],\n        // 弹出层标题\n        title: \"\",\n        // 是否显示弹出层\n        open: false,\n        // 查询参数\n        queryParams: {\n          pageNum: 1,\n          pageSize: 10,\n          imgSrc: undefined,\n        },\n        // 表单参数\n\n        form: {},\n\n        // 表单校验\n\n        rules: {\n\n        }\n\n      };\n\n    },\n\n    created() {\n      // this.onTake()\n    },\n\t\n    methods: {\n\n      /*调用摄像头拍照开始*/\n\n      onTake() {\n\n        this.visible = true;\n\n        this.getCompetence();\n\n      },\n\n      onCancel() {\n\t\tthis.uploadImg()\n        this.visible = false;\n        /* this.resetCanvas();*/\n\n        this.stopNavigator();\n\n      },\r\n\t  uploadSuccess(e){\r\n\t\t  this.visible = false;\r\n\t\t  this.$emit('imgChange', e.file)\r\n\t  },\n\t\tuploadImg(){\r\n\t\t\tlet param = new FormData()\r\n\t\t\t　　param.append('file',this.base64toFile(this.imgSrc))\r\n\t\t\tthis.$http.post('file/upload',param).then(res=>{\r\n\t\t\t\tthis.$emit('imgChange', res.data.file)\r\n\t\t\t})\r\n\t\t},\r\n\t\tbase64toFile (dataurl, filename = 'file') {\r\n\t\t  let arr = dataurl.split(',')\r\n\t\t        let mime = arr[0].match(/:(.*?);/)[1]\r\n\t\t        let suffix = mime.split('/')[1]\r\n\t\t        let bstr = atob(arr[1])\r\n\t\t        let n = bstr.length\r\n\t\t        let u8arr = new Uint8Array(n)\r\n\t\t        while (n--) {\r\n\t\t          u8arr[n] = bstr.charCodeAt(n)\r\n\t\t        }\r\n\t\t        let file = new File([u8arr], `${filename}.${suffix}`, {\r\n\t\t          type: mime\r\n\t\t        })\r\n\t\t        return file\r\n\t\t},\n      // 调用摄像头权限\n\n      getCompetence() {\n\n        //必须在model中render后才可获取到dom节点,直接获取无法获取到model中的dom节点\n\n        this.$nextTick(() => {\n\n          const _this = this;\n\n          this.os = false; //切换成关闭摄像头\n\n          this.thisCancas = document.getElementById('canvasCamera');\n\n          this.thisContext = this.thisCancas.getContext('2d');\n\n          this.thisVideo = document.getElementById('videoCamera');\n\n          // 旧版本浏览器可能根本不支持mediaDevices，我们首先设置一个空对象\n\n          if (navigator.mediaDevices === undefined) {\n\n            navigator.menavigatordiaDevices = {}\n\n          }\n\n          // 一些浏览器实现了部分mediaDevices，我们不能只分配一个对象\n\n          // 使用getUserMedia，因为它会覆盖现有的属性。\n\n          // 这里，如果缺少getUserMedia属性，就添加它。\n\n          if (navigator.mediaDevices.getUserMedia === undefined) {\n\n            navigator.mediaDevices.getUserMedia = function(constraints) {\n\n              // 首先获取现存的getUserMedia(如果存在)\n\n              let getUserMedia = navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator\n                .getUserMedia;\n\n              // 有些浏览器不支持，会返回错误信息\n\n              // 保持接口一致\n\n              if (!getUserMedia) {\n\n                return Promise.reject(new Error('getUserMedia is not implemented in this browser'))\n\n              }\n\n              // 否则，使用Promise将调用包装到旧的navigator.getUserMedia\n\n              return new Promise(function(resolve, reject) {\n\n                getUserMedia.call(navigator, constraints, resolve, reject)\n\n              })\n\n            }\n\n          }\n\n          const constraints = {\n\n            audio: false,\n\n            video: {\n              width: _this.videoWidth,\n              height: _this.videoHeight,\n              transform: 'scaleX(-1)'\n            }\n\n          };\n\n          navigator.mediaDevices.getUserMedia(constraints).then(function(stream) {\n\n            // 旧的浏览器可能没有srcObject\n\n            if ('srcObject' in _this.thisVideo) {\n\n              _this.thisVideo.srcObject = stream\n\n            } else {\n\n              // 避免在新的浏览器中使用它，因为它正在被弃用。\n\n              _this.thisVideo.src = window.URL.createObjectURL(stream)\n\n            }\n\n            _this.thisVideo.onloadedmetadata = function(e) {\n\n              _this.thisVideo.play()\n\n            }\n\n          }).catch(err => {\n\n            this.$notify({\n\n              title: '警告',\n\n              message: '没有开启摄像头权限或浏览器版本不兼容.',\n\n              type: 'warning'\n\n            });\n\n          });\n\n        });\n\n      },\n\n      //绘制图片\n\n      drawImage() {\n\n        // 点击，canvas画图\n\n        this.thisContext.drawImage(this.thisVideo, 0, 0, this.videoWidth, this.videoHeight);\n\n        // 获取图片base64链接\n\n        this.imgSrc = this.thisCancas.toDataURL('image/png');\n\n        /*const imgSrc=this.imgSrc;*/\n\n      },\n\n      //清空画布\n\n      clearCanvas(id) {\n\n        let c = document.getElementById(id);\n\n        let cxt = c.getContext(\"2d\");\n\n        cxt.clearRect(0, 0, c.width, c.height);\n\n      },\n\n      //重置画布\n\n      resetCanvas() {\n\n        this.imgSrc = \"\";\n\n        this.clearCanvas('canvasCamera');\n\n      },\n\n      //关闭摄像头\n\n      stopNavigator() {\n\n        if (this.thisVideo && this.thisVideo !== null) {\n\n          this.thisVideo.srcObject.getTracks()[0].stop();\n\n          this.os = true; //切换成打开摄像头\n\n        }\n\n      },\n\n      /*调用摄像头拍照结束*/\n\n    }\n\n  };\n</script>\n<style rel=\"stylesheet/scss\" lang=\"scss\" scoped>\n\n  .avatar-uploader .el-upload {\n    border: 1px dashed #ccc;\n    border-radius: 6px;\n    cursor: pointer;\n    position: relative;\n    overflow: hidden;\n  }\n\n  .avatar-uploader .el-upload:hover {\n    border-color: #409EFF;\n  }\n\n  .avatar-uploader-icon {\n    font-size: 28px;\n    color: #8c939d;\n    width: 178px;\n    height: 178px;\n    line-height: 178px;\n    text-align: center;\n    border: 1px dashed #ccc;\n  }\n\n  .avatar {\n    width: 178px;\n    height: 178px;\n    display: block;\n  }\n</style>\n"]}]}