{"remainingRequest":"/Users/shaofeng/Desktop/pythonUSMS/api/templates/front/front/node_modules/babel-loader/lib/index.js!/Users/shaofeng/Desktop/pythonUSMS/api/templates/front/front/node_modules/cache-loader/dist/cjs.js??ref--1-0!/Users/shaofeng/Desktop/pythonUSMS/api/templates/front/front/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/shaofeng/Desktop/pythonUSMS/api/templates/front/front/src/components/img.vue?vue&type=script&lang=js","dependencies":[{"path":"/Users/shaofeng/Desktop/pythonUSMS/api/templates/front/front/src/components/img.vue","mtime":1757151569990},{"path":"/Users/shaofeng/Desktop/pythonUSMS/api/templates/front/front/babel.config.js","mtime":1713772402000},{"path":"/Users/shaofeng/Desktop/pythonUSMS/api/templates/front/front/node_modules/cache-loader/dist/cjs.js","mtime":1757151725167},{"path":"/Users/shaofeng/Desktop/pythonUSMS/api/templates/front/front/node_modules/babel-loader/lib/index.js","mtime":1757151725372},{"path":"/Users/shaofeng/Desktop/pythonUSMS/api/templates/front/front/node_modules/cache-loader/dist/cjs.js","mtime":1757151725167},{"path":"/Users/shaofeng/Desktop/pythonUSMS/api/templates/front/front/node_modules/vue-loader/lib/index.js","mtime":1757151725403}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZXJyb3IuY2F1c2UuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS1idWZmZXIuZGV0YWNoZWQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS1idWZmZXIudHJhbnNmZXIuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS1idWZmZXIudHJhbnNmZXItdG8tZml4ZWQtbGVuZ3RoLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMudHlwZWQtYXJyYXkuYXQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5maW5kLWxhc3QuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5maW5kLWxhc3QtaW5kZXguanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS5zZXQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy50eXBlZC1hcnJheS50by1yZXZlcnNlZC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LnRvLXNvcnRlZC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLnR5cGVkLWFycmF5LndpdGguanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lc25leHQudWludDgtYXJyYXkuc2V0LWZyb20tYmFzZTY0LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXNuZXh0LnVpbnQ4LWFycmF5LnNldC1mcm9tLWhleC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzbmV4dC51aW50OC1hcnJheS50by1iYXNlNjQuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lc25leHQudWludDgtYXJyYXkudG8taGV4LmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLmRvbS1leGNlcHRpb24uc3RhY2suanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIudXJsLXNlYXJjaC1wYXJhbXMuZGVsZXRlLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvd2ViLnVybC1zZWFyY2gtcGFyYW1zLmhhcy5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL3dlYi51cmwtc2VhcmNoLXBhcmFtcy5zaXplLmpzIjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAiWFhYIiwKICBkYXRhKCkgewogICAgcmV0dXJuIHsKICAgICAgYmFzZVVybDogYCR7dGhpcy4kY29uZmlnLmJhc2VVcmx9YCwKICAgICAgdmlzaWJsZTogZmFsc2UsCiAgICAgIC8v5by556qXCiAgICAgIGxvYWRpbmc6IGZhbHNlLAogICAgICAvL+S4iuS8oOaMiemSruWKoOi9vQogICAgICBvczogZmFsc2UsCiAgICAgIC8v5o6n5Yi25pGE5YOP5aS05byA5YWzCiAgICAgIHRoaXNWaWRlbzogbnVsbCwKICAgICAgdGhpc0NvbnRleHQ6IG51bGwsCiAgICAgIHRoaXNDYW5jYXM6IG51bGwsCiAgICAgIHZpZGVvV2lkdGg6IDUwMCwKICAgICAgdmlkZW9IZWlnaHQ6IDQwMCwKICAgICAgcG9zdE9wdGlvbnM6IFtdLAogICAgICBDZXJ0Q3RsOiAnJywKICAgICAgLy8g6YGu572p5bGCCiAgICAgIGxvYWRpbmc6IHRydWUsCiAgICAgIC8vIOmAieS4reaVsOe7hAogICAgICBpZHM6IFtdLAogICAgICAvLyDpnZ7ljZXkuKrnpoHnlKgKICAgICAgc2luZ2xlOiB0cnVlLAogICAgICAvLyDpnZ7lpJrkuKrnpoHnlKgKICAgICAgbXVsdGlwbGU6IHRydWUsCiAgICAgIC8vIOaAu+adoeaVsAogICAgICB0b3RhbDogMCwKICAgICAgLy8g6aG555uu5Lq65ZGY6KGo5qC85pWw5o2uCiAgICAgIGFrd29ya2VyTGlzdDogW10sCiAgICAgIC8v5bel56eN57G75Yir5pWw5o2u5a2X5YW4CiAgICAgIHdvcmtlclR5cGVPcHRpb25zOiBbXSwKICAgICAgLy8g5by55Ye65bGC5qCH6aKYCiAgICAgIHRpdGxlOiAiIiwKICAgICAgLy8g5piv5ZCm5pi+56S65by55Ye65bGCCiAgICAgIG9wZW46IGZhbHNlLAogICAgICAvLyDmn6Xor6Llj4LmlbAKICAgICAgcXVlcnlQYXJhbXM6IHsKICAgICAgICBwYWdlTnVtOiAxLAogICAgICAgIHBhZ2VTaXplOiAxMCwKICAgICAgICBpbWdTcmM6IHVuZGVmaW5lZAogICAgICB9LAogICAgICAvLyDooajljZXlj4LmlbAKCiAgICAgIGZvcm06IHt9LAogICAgICAvLyDooajljZXmoKHpqowKCiAgICAgIHJ1bGVzOiB7fQogICAgfTsKICB9LAogIGNvbXB1dGVkOiB7CiAgICAvLyDorqHnrpflsZ7mgKfnmoQgZ2V0dGVyCiAgICBnZXRBY3Rpb25Vcmw6IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIHRoaXMuYmFzZVVybCArICdmaWxlL3VwbG9hZCc7CiAgICB9CiAgfSwKICBjcmVhdGVkKCkgewogICAgLy8gdGhpcy5vblRha2UoKQogIH0sCiAgbWV0aG9kczogewogICAgLyrosIPnlKjmkYTlg4/lpLTmi43nhaflvIDlp4sqLwoKICAgIG9uVGFrZSgpIHsKICAgICAgdGhpcy52aXNpYmxlID0gdHJ1ZTsKICAgICAgdGhpcy5nZXRDb21wZXRlbmNlKCk7CiAgICB9LAogICAgb25DYW5jZWwoKSB7CiAgICAgIHRoaXMudXBsb2FkSW1nKCk7CiAgICAgIHRoaXMudmlzaWJsZSA9IGZhbHNlOwogICAgICAvKiB0aGlzLnJlc2V0Q2FudmFzKCk7Ki8KCiAgICAgIHRoaXMuc3RvcE5hdmlnYXRvcigpOwogICAgfSwKICAgIHVwbG9hZFN1Y2Nlc3MoZSkgewogICAgICB0aGlzLnZpc2libGUgPSBmYWxzZTsKICAgICAgdGhpcy4kZW1pdCgnaW1nQ2hhbmdlJywgZS5maWxlKTsKICAgIH0sCiAgICB1cGxvYWRJbWcoKSB7CiAgICAgIGxldCBwYXJhbSA9IG5ldyBGb3JtRGF0YSgpOwogICAgICBwYXJhbS5hcHBlbmQoJ2ZpbGUnLCB0aGlzLmJhc2U2NHRvRmlsZSh0aGlzLmltZ1NyYykpOwogICAgICB0aGlzLiRodHRwLnBvc3QoJ2ZpbGUvdXBsb2FkJywgcGFyYW0pLnRoZW4ocmVzID0+IHsKICAgICAgICB0aGlzLiRlbWl0KCdpbWdDaGFuZ2UnLCByZXMuZGF0YS5maWxlKTsKICAgICAgfSk7CiAgICB9LAogICAgYmFzZTY0dG9GaWxlKGRhdGF1cmwsIGZpbGVuYW1lID0gJ2ZpbGUnKSB7CiAgICAgIGxldCBhcnIgPSBkYXRhdXJsLnNwbGl0KCcsJyk7CiAgICAgIGxldCBtaW1lID0gYXJyWzBdLm1hdGNoKC86KC4qPyk7LylbMV07CiAgICAgIGxldCBzdWZmaXggPSBtaW1lLnNwbGl0KCcvJylbMV07CiAgICAgIGxldCBic3RyID0gYXRvYihhcnJbMV0pOwogICAgICBsZXQgbiA9IGJzdHIubGVuZ3RoOwogICAgICBsZXQgdThhcnIgPSBuZXcgVWludDhBcnJheShuKTsKICAgICAgd2hpbGUgKG4tLSkgewogICAgICAgIHU4YXJyW25dID0gYnN0ci5jaGFyQ29kZUF0KG4pOwogICAgICB9CiAgICAgIGxldCBmaWxlID0gbmV3IEZpbGUoW3U4YXJyXSwgYCR7ZmlsZW5hbWV9LiR7c3VmZml4fWAsIHsKICAgICAgICB0eXBlOiBtaW1lCiAgICAgIH0pOwogICAgICByZXR1cm4gZmlsZTsKICAgIH0sCiAgICAvLyDosIPnlKjmkYTlg4/lpLTmnYPpmZAKCiAgICBnZXRDb21wZXRlbmNlKCkgewogICAgICAvL+W/hemhu+WcqG1vZGVs5LitcmVuZGVy5ZCO5omN5Y+v6I635Y+W5YiwZG9t6IqC54K5LOebtOaOpeiOt+WPluaXoOazleiOt+WPluWIsG1vZGVs5Lit55qEZG9t6IqC54K5CgogICAgICB0aGlzLiRuZXh0VGljaygoKSA9PiB7CiAgICAgICAgY29uc3QgX3RoaXMgPSB0aGlzOwogICAgICAgIHRoaXMub3MgPSBmYWxzZTsgLy/liIfmjaLmiJDlhbPpl63mkYTlg4/lpLQKCiAgICAgICAgdGhpcy50aGlzQ2FuY2FzID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2NhbnZhc0NhbWVyYScpOwogICAgICAgIHRoaXMudGhpc0NvbnRleHQgPSB0aGlzLnRoaXNDYW5jYXMuZ2V0Q29udGV4dCgnMmQnKTsKICAgICAgICB0aGlzLnRoaXNWaWRlbyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd2aWRlb0NhbWVyYScpOwoKICAgICAgICAvLyDml6fniYjmnKzmtY/op4jlmajlj6/og73moLnmnKzkuI3mlK/mjIFtZWRpYURldmljZXPvvIzmiJHku6zpppblhYjorr7nva7kuIDkuKrnqbrlr7nosaEKCiAgICAgICAgaWYgKG5hdmlnYXRvci5tZWRpYURldmljZXMgPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgbmF2aWdhdG9yLm1lbmF2aWdhdG9yZGlhRGV2aWNlcyA9IHt9OwogICAgICAgIH0KCiAgICAgICAgLy8g5LiA5Lqb5rWP6KeI5Zmo5a6e546w5LqG6YOo5YiGbWVkaWFEZXZpY2Vz77yM5oiR5Lus5LiN6IO95Y+q5YiG6YWN5LiA5Liq5a+56LGhCgogICAgICAgIC8vIOS9v+eUqGdldFVzZXJNZWRpYe+8jOWboOS4uuWug+S8muimhueblueOsOacieeahOWxnuaAp+OAggoKICAgICAgICAvLyDov5nph4zvvIzlpoLmnpznvLrlsJFnZXRVc2VyTWVkaWHlsZ7mgKfvvIzlsLHmt7vliqDlroPjgIIKCiAgICAgICAgaWYgKG5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0VXNlck1lZGlhID09PSB1bmRlZmluZWQpIHsKICAgICAgICAgIG5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0VXNlck1lZGlhID0gZnVuY3Rpb24gKGNvbnN0cmFpbnRzKSB7CiAgICAgICAgICAgIC8vIOmmluWFiOiOt+WPlueOsOWtmOeahGdldFVzZXJNZWRpYSjlpoLmnpzlrZjlnKgpCgogICAgICAgICAgICBsZXQgZ2V0VXNlck1lZGlhID0gbmF2aWdhdG9yLndlYmtpdEdldFVzZXJNZWRpYSB8fCBuYXZpZ2F0b3IubW96R2V0VXNlck1lZGlhIHx8IG5hdmlnYXRvci5nZXRVc2VyTWVkaWE7CgogICAgICAgICAgICAvLyDmnInkupvmtY/op4jlmajkuI3mlK/mjIHvvIzkvJrov5Tlm57plJnor6/kv6Hmga8KCiAgICAgICAgICAgIC8vIOS/neaMgeaOpeWPo+S4gOiHtAoKICAgICAgICAgICAgaWYgKCFnZXRVc2VyTWVkaWEpIHsKICAgICAgICAgICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QobmV3IEVycm9yKCdnZXRVc2VyTWVkaWEgaXMgbm90IGltcGxlbWVudGVkIGluIHRoaXMgYnJvd3NlcicpKTsKICAgICAgICAgICAgfQoKICAgICAgICAgICAgLy8g5ZCm5YiZ77yM5L2/55SoUHJvbWlzZeWwhuiwg+eUqOWMheijheWIsOaXp+eahG5hdmlnYXRvci5nZXRVc2VyTWVkaWEKCiAgICAgICAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgICAgICAgICAgZ2V0VXNlck1lZGlhLmNhbGwobmF2aWdhdG9yLCBjb25zdHJhaW50cywgcmVzb2x2ZSwgcmVqZWN0KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9OwogICAgICAgIH0KICAgICAgICBjb25zdCBjb25zdHJhaW50cyA9IHsKICAgICAgICAgIGF1ZGlvOiBmYWxzZSwKICAgICAgICAgIHZpZGVvOiB7CiAgICAgICAgICAgIHdpZHRoOiBfdGhpcy52aWRlb1dpZHRoLAogICAgICAgICAgICBoZWlnaHQ6IF90aGlzLnZpZGVvSGVpZ2h0LAogICAgICAgICAgICB0cmFuc2Zvcm06ICdzY2FsZVgoLTEpJwogICAgICAgICAgfQogICAgICAgIH07CiAgICAgICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEoY29uc3RyYWludHMpLnRoZW4oZnVuY3Rpb24gKHN0cmVhbSkgewogICAgICAgICAgLy8g5pen55qE5rWP6KeI5Zmo5Y+v6IO95rKh5pyJc3JjT2JqZWN0CgogICAgICAgICAgaWYgKCdzcmNPYmplY3QnIGluIF90aGlzLnRoaXNWaWRlbykgewogICAgICAgICAgICBfdGhpcy50aGlzVmlkZW8uc3JjT2JqZWN0ID0gc3RyZWFtOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgLy8g6YG/5YWN5Zyo5paw55qE5rWP6KeI5Zmo5Lit5L2/55So5a6D77yM5Zug5Li65a6D5q2j5Zyo6KKr5byD55So44CCCgogICAgICAgICAgICBfdGhpcy50aGlzVmlkZW8uc3JjID0gd2luZG93LlVSTC5jcmVhdGVPYmplY3RVUkwoc3RyZWFtKTsKICAgICAgICAgIH0KICAgICAgICAgIF90aGlzLnRoaXNWaWRlby5vbmxvYWRlZG1ldGFkYXRhID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgX3RoaXMudGhpc1ZpZGVvLnBsYXkoKTsKICAgICAgICAgIH07CiAgICAgICAgfSkuY2F0Y2goZXJyID0+IHsKICAgICAgICAgIHRoaXMuJG5vdGlmeSh7CiAgICAgICAgICAgIHRpdGxlOiAn6K2m5ZGKJywKICAgICAgICAgICAgbWVzc2FnZTogJ+ayoeacieW8gOWQr+aRhOWDj+WktOadg+mZkOaIlua1j+iniOWZqOeJiOacrOS4jeWFvOWuuS4nLAogICAgICAgICAgICB0eXBlOiAnd2FybmluZycKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0sCiAgICAvL+e7mOWItuWbvueJhwoKICAgIGRyYXdJbWFnZSgpIHsKICAgICAgLy8g54K55Ye777yMY2FudmFz55S75Zu+CgogICAgICB0aGlzLnRoaXNDb250ZXh0LmRyYXdJbWFnZSh0aGlzLnRoaXNWaWRlbywgMCwgMCwgdGhpcy52aWRlb1dpZHRoLCB0aGlzLnZpZGVvSGVpZ2h0KTsKCiAgICAgIC8vIOiOt+WPluWbvueJh2Jhc2U2NOmTvuaOpQoKICAgICAgdGhpcy5pbWdTcmMgPSB0aGlzLnRoaXNDYW5jYXMudG9EYXRhVVJMKCdpbWFnZS9wbmcnKTsKCiAgICAgIC8qY29uc3QgaW1nU3JjPXRoaXMuaW1nU3JjOyovCiAgICB9LAogICAgLy/muIXnqbrnlLvluIMKCiAgICBjbGVhckNhbnZhcyhpZCkgewogICAgICBsZXQgYyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKGlkKTsKICAgICAgbGV0IGN4dCA9IGMuZ2V0Q29udGV4dCgiMmQiKTsKICAgICAgY3h0LmNsZWFyUmVjdCgwLCAwLCBjLndpZHRoLCBjLmhlaWdodCk7CiAgICB9LAogICAgLy/ph43nva7nlLvluIMKCiAgICByZXNldENhbnZhcygpIHsKICAgICAgdGhpcy5pbWdTcmMgPSAiIjsKICAgICAgdGhpcy5jbGVhckNhbnZhcygnY2FudmFzQ2FtZXJhJyk7CiAgICB9LAogICAgLy/lhbPpl63mkYTlg4/lpLQKCiAgICBzdG9wTmF2aWdhdG9yKCkgewogICAgICBpZiAodGhpcy50aGlzVmlkZW8gJiYgdGhpcy50aGlzVmlkZW8gIT09IG51bGwpIHsKICAgICAgICB0aGlzLnRoaXNWaWRlby5zcmNPYmplY3QuZ2V0VHJhY2tzKClbMF0uc3RvcCgpOwogICAgICAgIHRoaXMub3MgPSB0cnVlOyAvL+WIh+aNouaIkOaJk+W8gOaRhOWDj+WktAogICAgICB9CiAgICB9CgogICAgLyrosIPnlKjmkYTlg4/lpLTmi43nhafnu5PmnZ8qLwogIH0KfTs="},{"version":3,"names":["name","data","baseUrl","$config","visible","loading","os","thisVideo","thisContext","thisCancas","videoWidth","videoHeight","postOptions","CertCtl","ids","single","multiple","total","akworkerList","workerTypeOptions","title","open","queryParams","pageNum","pageSize","imgSrc","undefined","form","rules","computed","getActionUrl","created","methods","onTake","getCompetence","onCancel","uploadImg","stopNavigator","uploadSuccess","e","$emit","file","param","FormData","append","base64toFile","$http","post","then","res","dataurl","filename","arr","split","mime","match","suffix","bstr","atob","n","length","u8arr","Uint8Array","charCodeAt","File","type","$nextTick","_this","document","getElementById","getContext","navigator","mediaDevices","menavigatordiaDevices","getUserMedia","constraints","webkitGetUserMedia","mozGetUserMedia","Promise","reject","Error","resolve","call","audio","video","width","height","transform","stream","srcObject","src","window","URL","createObjectURL","onloadedmetadata","play","catch","err","$notify","message","drawImage","toDataURL","clearCanvas","id","c","cxt","clearRect","resetCanvas","getTracks","stop"],"sources":["src/components/img.vue"],"sourcesContent":["<template>\r\n\t<el-dialog title=\"拍照上传\" :visible.sync=\"visible\" width=\"1065px\">\r\n\t\t<div class=\"box\">\r\n\t\t\t<video id=\"videoCamera\" class=\"canvas\" :width=\"videoWidth\" :height=\"videoHeight\" autoPlay></video>\r\n\t\t\t<canvas id=\"canvasCamera\" class=\"canvas\" :width=\"videoWidth\" :height=\"videoHeight\"></canvas>\r\n\t\t</div>\r\n\t\t<div slot=\"footer\" style=\"display:flex\">\r\n\t\t\t<el-upload :action=\"getActionUrl\" :on-success=\"uploadSuccess\" :show-file-list=\"false\"\r\n\t\t\t\taccept=\".jpg,.png,.jpge\" style=\"margin-right:10px\">\r\n\t\t\t\t<el-button icon=\"el-icon-upload2\" size=\"small\">\r\n\t\t\t\t\t上传图片\r\n\t\t\t\t</el-button>\r\n\t\t\t</el-upload>\r\n\r\n\t\t\t<el-button @click=\"drawImage\" icon=\"el-icon-camera\" size=\"small\">\r\n\t\t\t\t拍照\r\n\t\t\t</el-button>\r\n\t\t\t<el-button v-if=\"os\" @click=\"getCompetence\" icon=\"el-icon-video-camera\" size=\"small\">\r\n\t\t\t\t打开摄像头\r\n\t\t\t</el-button>\r\n\t\t\t<el-button v-else @click=\"stopNavigator\" icon=\"el-icon-switch-button\" size=\"small\">\r\n\t\t\t\t关闭摄像头\r\n\t\t\t</el-button>\r\n\t\t\t<el-button @click=\"resetCanvas\" icon=\"el-icon-refresh\" size=\"small\">\r\n\t\t\t\t重置\r\n\t\t\t</el-button>\r\n\t\t\t<el-button @click=\"onCancel\" icon=\"el-icon-circle-close\" size=\"small\">\r\n\t\t\t\t完成\r\n\t\t\t</el-button>\r\n\t\t</div>\r\n\t</el-dialog>\r\n</template>\r\n<script>\r\n\texport default {\r\n\t\tname: \"XXX\",\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tbaseUrl: `${this.$config.baseUrl}`,\r\n\t\t\t\tvisible: false, //弹窗\r\n\t\t\t\tloading: false, //上传按钮加载\r\n\t\t\t\tos: false, //控制摄像头开关\r\n\t\t\t\tthisVideo: null,\r\n\t\t\t\tthisContext: null,\r\n\t\t\t\tthisCancas: null,\r\n\t\t\t\tvideoWidth: 500,\r\n\t\t\t\tvideoHeight: 400,\r\n\t\t\t\tpostOptions: [],\r\n\t\t\t\tCertCtl: '',\r\n\t\t\t\t// 遮罩层\r\n\t\t\t\tloading: true,\r\n\t\t\t\t// 选中数组\r\n\t\t\t\tids: [],\r\n\t\t\t\t// 非单个禁用\r\n\t\t\t\tsingle: true,\r\n\t\t\t\t// 非多个禁用\r\n\t\t\t\tmultiple: true,\r\n\t\t\t\t// 总条数\r\n\t\t\t\ttotal: 0,\r\n\t\t\t\t// 项目人员表格数据\r\n\t\t\t\takworkerList: [],\r\n\t\t\t\t//工种类别数据字典\r\n\t\t\t\tworkerTypeOptions: [],\r\n\t\t\t\t// 弹出层标题\r\n\t\t\t\ttitle: \"\",\r\n\t\t\t\t// 是否显示弹出层\r\n\t\t\t\topen: false,\r\n\t\t\t\t// 查询参数\r\n\t\t\t\tqueryParams: {\r\n\t\t\t\t\tpageNum: 1,\r\n\t\t\t\t\tpageSize: 10,\r\n\t\t\t\t\timgSrc: undefined,\r\n\t\t\t\t},\r\n\t\t\t\t// 表单参数\r\n\r\n\t\t\t\tform: {},\r\n\r\n\t\t\t\t// 表单校验\r\n\r\n\t\t\t\trules: {\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t};\r\n\r\n\t\t},\r\n\t\tcomputed: {\r\n\t\t\t// 计算属性的 getter\r\n\t\t\tgetActionUrl: function() {\r\n\t\t\t\treturn this.baseUrl + 'file/upload';\r\n\t\t\t}\r\n\t\t},\r\n\t\tcreated() {\r\n\t\t\t// this.onTake()\r\n\t\t},\r\n\r\n\t\tmethods: {\r\n\r\n\t\t\t/*调用摄像头拍照开始*/\r\n\r\n\t\t\tonTake() {\r\n\r\n\t\t\t\tthis.visible = true;\r\n\r\n\t\t\t\tthis.getCompetence();\r\n\r\n\t\t\t},\r\n\r\n\t\t\tonCancel() {\r\n\t\t\t\tthis.uploadImg()\r\n\t\t\t\tthis.visible = false;\r\n\t\t\t\t/* this.resetCanvas();*/\r\n\r\n\t\t\t\tthis.stopNavigator();\r\n\r\n\t\t\t},\r\n\t\t\tuploadSuccess(e) {\r\n\t\t\t\tthis.visible = false;\r\n\t\t\t\tthis.$emit('imgChange', e.file)\r\n\t\t\t},\r\n\t\t\tuploadImg() {\r\n\t\t\t\tlet param = new FormData()\r\n\t\t\t\tparam.append('file', this.base64toFile(this.imgSrc))\r\n\t\t\t\tthis.$http.post('file/upload', param).then(res => {\r\n\t\t\t\t\tthis.$emit('imgChange', res.data.file)\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tbase64toFile(dataurl, filename = 'file') {\r\n\t\t\t\tlet arr = dataurl.split(',')\r\n\t\t\t\tlet mime = arr[0].match(/:(.*?);/)[1]\r\n\t\t\t\tlet suffix = mime.split('/')[1]\r\n\t\t\t\tlet bstr = atob(arr[1])\r\n\t\t\t\tlet n = bstr.length\r\n\t\t\t\tlet u8arr = new Uint8Array(n)\r\n\t\t\t\twhile (n--) {\r\n\t\t\t\t\tu8arr[n] = bstr.charCodeAt(n)\r\n\t\t\t\t}\r\n\t\t\t\tlet file = new File([u8arr], `${filename}.${suffix}`, {\r\n\t\t\t\t\ttype: mime\r\n\t\t\t\t})\r\n\t\t\t\treturn file\r\n\t\t\t},\r\n\t\t\t// 调用摄像头权限\r\n\r\n\t\t\tgetCompetence() {\r\n\r\n\t\t\t\t//必须在model中render后才可获取到dom节点,直接获取无法获取到model中的dom节点\r\n\r\n\t\t\t\tthis.$nextTick(() => {\r\n\r\n\t\t\t\t\tconst _this = this;\r\n\r\n\t\t\t\t\tthis.os = false; //切换成关闭摄像头\r\n\r\n\t\t\t\t\tthis.thisCancas = document.getElementById('canvasCamera');\r\n\r\n\t\t\t\t\tthis.thisContext = this.thisCancas.getContext('2d');\r\n\r\n\t\t\t\t\tthis.thisVideo = document.getElementById('videoCamera');\r\n\r\n\t\t\t\t\t// 旧版本浏览器可能根本不支持mediaDevices，我们首先设置一个空对象\r\n\r\n\t\t\t\t\tif (navigator.mediaDevices === undefined) {\r\n\r\n\t\t\t\t\t\tnavigator.menavigatordiaDevices = {}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\t// 一些浏览器实现了部分mediaDevices，我们不能只分配一个对象\r\n\r\n\t\t\t\t\t// 使用getUserMedia，因为它会覆盖现有的属性。\r\n\r\n\t\t\t\t\t// 这里，如果缺少getUserMedia属性，就添加它。\r\n\r\n\t\t\t\t\tif (navigator.mediaDevices.getUserMedia === undefined) {\r\n\r\n\t\t\t\t\t\tnavigator.mediaDevices.getUserMedia = function(constraints) {\r\n\r\n\t\t\t\t\t\t\t// 首先获取现存的getUserMedia(如果存在)\r\n\r\n\t\t\t\t\t\t\tlet getUserMedia = navigator.webkitGetUserMedia || navigator.mozGetUserMedia ||\r\n\t\t\t\t\t\t\t\tnavigator\r\n\t\t\t\t\t\t\t\t.getUserMedia;\r\n\r\n\t\t\t\t\t\t\t// 有些浏览器不支持，会返回错误信息\r\n\r\n\t\t\t\t\t\t\t// 保持接口一致\r\n\r\n\t\t\t\t\t\t\tif (!getUserMedia) {\r\n\r\n\t\t\t\t\t\t\t\treturn Promise.reject(new Error(\r\n\t\t\t\t\t\t\t\t\t'getUserMedia is not implemented in this browser'))\r\n\r\n\t\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t\t// 否则，使用Promise将调用包装到旧的navigator.getUserMedia\r\n\r\n\t\t\t\t\t\t\treturn new Promise(function(resolve, reject) {\r\n\r\n\t\t\t\t\t\t\t\tgetUserMedia.call(navigator, constraints, resolve, reject)\r\n\r\n\t\t\t\t\t\t\t})\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}\r\n\r\n\t\t\t\t\tconst constraints = {\r\n\r\n\t\t\t\t\t\taudio: false,\r\n\r\n\t\t\t\t\t\tvideo: {\r\n\t\t\t\t\t\t\twidth: _this.videoWidth,\r\n\t\t\t\t\t\t\theight: _this.videoHeight,\r\n\t\t\t\t\t\t\ttransform: 'scaleX(-1)'\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t};\r\n\r\n\t\t\t\t\tnavigator.mediaDevices.getUserMedia(constraints).then(function(stream) {\r\n\r\n\t\t\t\t\t\t// 旧的浏览器可能没有srcObject\r\n\r\n\t\t\t\t\t\tif ('srcObject' in _this.thisVideo) {\r\n\r\n\t\t\t\t\t\t\t_this.thisVideo.srcObject = stream\r\n\r\n\t\t\t\t\t\t} else {\r\n\r\n\t\t\t\t\t\t\t// 避免在新的浏览器中使用它，因为它正在被弃用。\r\n\r\n\t\t\t\t\t\t\t_this.thisVideo.src = window.URL.createObjectURL(stream)\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t\t_this.thisVideo.onloadedmetadata = function(e) {\r\n\r\n\t\t\t\t\t\t\t_this.thisVideo.play()\r\n\r\n\t\t\t\t\t\t}\r\n\r\n\t\t\t\t\t}).catch(err => {\r\n\r\n\t\t\t\t\t\tthis.$notify({\r\n\r\n\t\t\t\t\t\t\ttitle: '警告',\r\n\r\n\t\t\t\t\t\t\tmessage: '没有开启摄像头权限或浏览器版本不兼容.',\r\n\r\n\t\t\t\t\t\t\ttype: 'warning'\r\n\r\n\t\t\t\t\t\t});\r\n\r\n\t\t\t\t\t});\r\n\r\n\t\t\t\t});\r\n\r\n\t\t\t},\r\n\r\n\t\t\t//绘制图片\r\n\r\n\t\t\tdrawImage() {\r\n\r\n\t\t\t\t// 点击，canvas画图\r\n\r\n\t\t\t\tthis.thisContext.drawImage(this.thisVideo, 0, 0, this.videoWidth, this.videoHeight);\r\n\r\n\t\t\t\t// 获取图片base64链接\r\n\r\n\t\t\t\tthis.imgSrc = this.thisCancas.toDataURL('image/png');\r\n\r\n\t\t\t\t/*const imgSrc=this.imgSrc;*/\r\n\r\n\t\t\t},\r\n\r\n\t\t\t//清空画布\r\n\r\n\t\t\tclearCanvas(id) {\r\n\r\n\t\t\t\tlet c = document.getElementById(id);\r\n\r\n\t\t\t\tlet cxt = c.getContext(\"2d\");\r\n\r\n\t\t\t\tcxt.clearRect(0, 0, c.width, c.height);\r\n\r\n\t\t\t},\r\n\r\n\t\t\t//重置画布\r\n\r\n\t\t\tresetCanvas() {\r\n\r\n\t\t\t\tthis.imgSrc = \"\";\r\n\r\n\t\t\t\tthis.clearCanvas('canvasCamera');\r\n\r\n\t\t\t},\r\n\r\n\t\t\t//关闭摄像头\r\n\r\n\t\t\tstopNavigator() {\r\n\r\n\t\t\t\tif (this.thisVideo && this.thisVideo !== null) {\r\n\r\n\t\t\t\t\tthis.thisVideo.srcObject.getTracks()[0].stop();\r\n\r\n\t\t\t\t\tthis.os = true; //切换成打开摄像头\r\n\r\n\t\t\t\t}\r\n\r\n\t\t\t},\r\n\r\n\t\t\t/*调用摄像头拍照结束*/\r\n\r\n\t\t}\r\n\r\n\t};\r\n</script>\r\n<style rel=\"stylesheet/scss\" lang=\"scss\" scoped>\r\n\t.avatar-uploader .el-upload {\r\n\t\tborder: 1px dashed #ccc;\r\n\t\tborder-radius: 6px;\r\n\t\tcursor: pointer;\r\n\t\tposition: relative;\r\n\t\toverflow: hidden;\r\n\t}\r\n\r\n\t.avatar-uploader .el-upload:hover {\r\n\t\tborder-color: #409EFF;\r\n\t}\r\n\r\n\t.avatar-uploader-icon {\r\n\t\tfont-size: 28px;\r\n\t\tcolor: #8c939d;\r\n\t\twidth: 178px;\r\n\t\theight: 178px;\r\n\t\tline-height: 178px;\r\n\t\ttext-align: center;\r\n\t\tborder: 1px dashed #ccc;\r\n\t}\r\n\r\n\t.avatar {\r\n\t\twidth: 178px;\r\n\t\theight: 178px;\r\n\t\tdisplay: block;\r\n\t}\r\n</style>"],"mappings":"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","ignoreList":[]}]}